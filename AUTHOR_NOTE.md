# 作者的话：Copilot 工作流体系的演进与实践

> 本文旨在向首次接触本仓库的用户快速介绍 5 大核心工作流的设计动机、使用定位与真实演进经验，并分享如何开发与迭代属于你自己的 AI 协作工作流。

---

## 🧭 演进时间线（里程碑概览）

| 顺序 | 工作流 | 角色定位 | 主要目的 | 当前成熟度 |
|------|--------|----------|----------|-------------|
| 1 | 调试工作流 (debug-system) | 故障排查中枢 | 固化调试→提升交互效率 | ⭐⭐⭐⭐☆ |
| 2 | 文件整理工作流 (file-organize-system) | 结构治理辅助 | 结构清理 / 分类规范化 | ⭐⭐☆☆☆ |
| 3 | 分析工作流 (analysis_system) | 认知建立引擎 | 系统/模块理解与评估 | ⭐⭐⭐⭐☆ |
| 4 | 重构工作流 (refactor_system) | 渐进式改造执行器 | 模块级安全重构 | ⭐⭐⭐☆☆ |
| 5 | 版本对比工作流 (version-comparison-system) | 发布差异透视镜 | 补全/校准版本变更认知 | ⭐⭐⭐⭐☆ |

成熟度说明：结合规范完整性 / 模板充分度 / 真实使用反馈主观评估。

---

## 🔑 五大核心工作流概述

### 1. 调试工作流（起点 & 最成熟）

- 初衷：把“脑内临时策略”固化为可重复、可回溯、可沉淀的调试循环。
- 核心机制：固定 6 步循环 + PDCA + buglist + 轮次目录 + 模板记录 + 归档总结。
- 价值：显著减少“遗忘 / 跳步 / 上下文丢失”，促成 AI 高质量协作。
- 演进重点：强化阶段边界、引入经验萃取、控制无效赘述。

### 2. 文件整理工作流（轻量工具型）

- 初衷：解决开发过程中结构漂移、命名混乱、冗余遗留的问题。
- 使用频率较低 → 以“够用”为设计策略，未重投入精细化演进。
- 提供三种组织策略：优先级导向 / 类型导向 / 时间线导向。

### 3. 分析工作流（重构的前置入口）

- 目标：快速形成“结构 / 职责 / 质量 / 风险”全景认知，为后续重构与取舍决策提供依据。
- 特征：多维度多轮分析、阶段化输出、模板驱动（规划 / 报告 / 指标 / 专项专家视角）。
- 优化思路：让 AI 在“抽象→下钻→量化→回收”循环中保持节奏，不陷入细枝末节。

### 4. 重构工作流（约束 + 渐进 + 质量护栏）

- 输入建议：以分析工作流产出为起点 + 用户显式约束（范围、禁止事项、优先级）。
- 参考来源：论文《MermaidFlow: Redefining Agentic Workflow Generation via Safety-Constrained Evolutionary Programming》理念（用结构化 Mermaid 约束思维路径）。
- 实测经验：
  - 早期：AI 过度“执着”于 Mermaid 图，忽略后续步骤细节 → 已通过强调“图≠指令全集”修正。
  - 仍存问题：任务执行中常追加新需求 → 容易导致上下文膨胀与计划漂移。
- 实用建议：保持“模块级”粒度，避免“一锅端”式全局性重构；分阶段交付并显式冻结已完成范围。

### 5. 版本对比工作流（补全事实，校准认知）

- 背景痛点：开发计划文档滞后于真实实现；提交信息粒度不一；最终编写更新日志时常遗漏。
- 设计目标：用系统化对比（worktree + 分阶段 + 模块化）回收真实差异，并辅助补写 / 校正规划与日志。
- 三阶段结构：
  1. 概览（提交分类 / 变更规模 / 模块影响）
  2. 模块深度（自动识别模块 → 用户二次筛选 → 分析模板化）
  3. 文档与配置（结构变化、重要说明差异）
- 输出：版本比较报告 + 更新日志草稿 + 升级/兼容性提示。

---

## 🛠 如何开发你自己的工作流（实践建议）

1. 从“线性（顺序）型”开始：早期不要急于设计包含大量分支 / 嵌套循环的复杂流程。
2. 先做“模板容器”，再做“策略规则”：AI 擅长填空，不擅长“无模板即兴严肃组织”。
3. 选一个真实痛点场景反复使用 → 观察“AI 易出错点 / 赘述点 / 遗漏点”，再反向写入模板。
4. 控制模板密度：删掉不会被有效利用的章节；保留“关键决策+标准检查+成果出口”三类块。
5. 引入经验法则（ heuristics ）：
   - 延迟冲动：例如“遇到结构未扫清，不立刻优化实现”。
   - 双重审查：完成后再用“异常扫描清单”过一遍。
   - 节奏锚点：固定时间 / 文件数 / 阶段总结（防上下文漂移）。
6. 逐次内化：把“这次临时提示里效果好的语句”沉淀为模板固定段落。

---

## 📐 模板设计经验（关键要点）

| 关注点 | 反模式 | 改进策略 |
|--------|--------|----------|
| 章节过多 | AI 忽略后半段 | 分级：必填 / 可选 / 扩展；可选标注注释说明 |
| 抽象术语 | AI 生成空洞描述 | 用具体检验维度替换（示例：复杂度、耦合度、接口变化） |
| 指令歧义 | AI 自行发挥 | 用“禁止做 / 必须暂停点”显式声明控制点 |
| 总结缺验证 | 结果口号化 | 强制加入“证据引用 / 文件路径 / diff 依据” |
| 缺失败处理 | 一遇异常停摆 | 设计“异常兜底块”：降级策略 / 手动介入指引 |

---

## 🧪 让 AI “三思而后行” 的技巧

- 约束结构：明确阶段入口 / 退出条件 / 产出格式。
- 复盘插槽：每轮循环末尾插入“自检：是否遗漏 X / 是否偏离任务目标”。
- 任务冻结：阶段确认后，前序阶段内容仅允许追加“补充区”，禁止整体重写。
- 角色切换：在关键步骤引导 AI 临时“扮演审查者”而非继续生成者。

---

## 🔍 常见问题（FAQ 摘要）

| 问题 | 典型后果 | 建议 |
|------|----------|------|
| 模板太理想化 | 执行流于形式 | 用真实一次执行后的产物倒推裁剪 |
| 一次重构过大 | 上下文爆炸 / 计划游移 | 拆分为多轮模块级窗口 |
| 提交粒度混乱 | 更新日志不可回溯 | 结合工作流产物写提交说明草稿 |
| 忽视归档 | 经验难迁移 | 将“归档”列为最后一步且设为强约束 |

---

## 🚀 未来可能方向（展望）

- 自动化版本差异分类增强（语义+结构双通道）
- 变更风险热度图（结合提交频率 + 模块耦合度）
- 模板智能裁剪（根据任务规模自动降维）
- 工作流链式编排（分析→重构→回归验证全链）

---

## 🧾 致读者

这些工作流并不追求“完美一次成型”，而是在真实使用中不断磨合。若你也正被“重复耗时的协作指令”“混乱的分析记录”“难以复盘的重构”困扰，希望这里的结构化方法能提供一个起点。欢迎你基于自身场景继续演化，并把新的经验法则再反向注入模板。

> 如果你打算新增一个工作流：请先写下“1句话目的 + 3个核心机制 + 1个退出标准”，再动手建目录与模板。

---

**最后更新**: 2025-08-13  
**作者**: Copilot 工作流体系维护者
